import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
import numpy as np

def lagrange_interpolation(x, y, xp):
    n = len(x)
    yp = 0

    for i in range(n):
        term = y[i]
        for j in range(n):
            if j != i:
                term = term * (xp - x[j]) / (x[i] - x[j])
        yp += term

    return yp


# Input section
n = int(input("Enter number of data points: "))
x = []
y = []

for i in range(n):
    xi, yi = map(float, input(f"Enter x[{i}] and y[{i}] (space separated): ").split())
    x.append(xi)
    y.append(yi)

xp = float(input("Enter value of x to interpolate: "))
yp = lagrange_interpolation(x, y, xp)

print(f"\nInterpolated value at x = {xp:.4f} is y = {yp:.4f}")

# Plotting
choice = input("\nDo you want to plot the interpolation curve? (y/n): ")

if choice.lower() == 'y':
    x_plot = np.linspace(min(x), max(x), 200)
    y_plot = [lagrange_interpolation(x, y, xi) for xi in x_plot]

    plt.figure()
    plt.plot(x_plot, y_plot, label="Lagrange Polynomial")
    plt.scatter(x, y, color='red', label="Given Data Points")
    plt.scatter(xp, yp, marker='x', label="Interpolated Point")
    plt.xlabel("x")
    plt.ylabel("y")
    plt.title("Lagrange Interpolation")
    plt.legend()
    plt.grid(True)
    plt.savefig("lagrange_plot.png")
    
